<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Maker V32 - Evolution</title>
    <link href="https://fonts.googleapis.com/css2?family=Khand:wght@700&family=Mukta:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root { --accent: #009688; --accent-rgb: 0,150,136; --bg: #0f172a; }
        body { font-family: 'Mukta', sans-serif; background: #f8fafc; margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center; }
        .header { background: #0f172a; width: 100%; padding: 15px; text-align: center; border-bottom: 3px solid var(--accent); position: sticky; top: 0; z-index: 100; }
        .header h1 { margin: 0; font-size: 22px; color: var(--accent); font-family: 'Khand', sans-serif; letter-spacing: 1px; }

        .main { padding: 20px; max-width: 500px; width: 100%; box-sizing: border-box; }
        .editor { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        .section-label { font-size: 13px; font-weight: bold; color: #64748b; margin-bottom: 5px; display: block; }
        
        textarea, input[type="text"] { width: 100%; padding: 14px; margin-bottom: 12px; border-radius: 12px; border: 1.5px solid #e2e8f0; font-size: 16px; box-sizing: border-box; outline: none; }
        .color-row { display: flex; align-items: center; gap: 12px; margin-bottom: 15px; flex-wrap: wrap; padding: 10px; background: #f1f5f9; border-radius: 15px; }
        .c-btn { width: 35px; height: 35px; border-radius: 50%; cursor: pointer; border: 3px solid #fff; transition: 0.2s; }
        .c-btn.active { border-color: #0f172a; transform: scale(1.1); }
        .btn-gen { background: #0f172a; color: var(--accent); border: none; padding: 18px; border-radius: 15px; font-weight: bold; font-size: 19px; width: 100%; cursor: pointer; }

        /* V32 Rendering Engine */
        #render-wrap { position: absolute; left: -9999px; }
        #poster { width: 1080px; height: 1080px; background: #000; position: relative; overflow: hidden; border: 20px solid #fff; }
        .post-bg { width: 100%; height: 100%; object-fit: cover; position: absolute; }
        .post-overlay { position: absolute; bottom: 0; width: 100%; height: 50%; background: linear-gradient(transparent, rgba(0,0,0,1) 48%, #000); }
        
        .post-content { position: absolute; bottom: 140px; left: 100px; right: 100px; text-align: center; height: 380px; display: flex; align-items: center; justify-content: center; z-index: 5; }
        .post-desc { color: #fff; font-size: 52px; font-weight: 700; line-height: 1.65; width: 100%; text-shadow: 2px 2px 10px rgba(0,0,0,0.5); }
        
        /* V32: ‡§∏‡•Å‡§¨‡§ï ‡§π‡§æ‡§Ø‡§≤‡§æ‡§à‡§ü - ‡§®‡•ã ‡§¨‡•â‡§ï‡•ç‡§∏ ‡§´‡§ø‡§≤‡•Ä‡§Ç‡§ó */
        .highlight { 
            color: var(--accent); 
            font-family: 'Khand', sans-serif;
            display: inline;
            padding: 1px 6px; 
            margin: 0; 
            background: rgba(var(--accent-rgb), 0.12); /* ‡§Ö‡§§‡•ç‡§Ø‡§Ç‡§§ ‡§∏‡•å‡§Æ‡•ç‡§Ø ‡§¨‡•Ö‡§ï‡§ó‡•ç‡§∞‡§æ‡§â‡§Ç‡§° */
            border-radius: 8px;
            box-decoration-break: clone;
            -webkit-box-decoration-break: clone;
        }

        .post-footer { position: absolute; bottom: 50px; width: 100%; display: flex; justify-content: center; align-items: center; gap: 20px; color: #fff; font-size: 45px; font-family: 'Khand', sans-serif; font-weight: bold; }
        .social-svg { width: 50px; height: 50px; fill: var(--accent); }
    </style>
</head>
<body>

<div class="header"><h1>BAATMI POINT V32</h1></div>

<div class="main">
    <div class="editor">
        <span class="section-label">‡•ß. ‡§¨‡§æ‡§§‡§Æ‡•Ä‡§ö‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞</span>
        <textarea id="uDesc" rows="4" placeholder="‡§Ø‡•á‡§•‡•á ‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§¨‡§æ‡§§‡§Æ‡•Ä ‡§≤‡§ø‡§π‡§æ..."></textarea>
        
        <span class="section-label">‡•®. ‡§π‡§æ‡§Ø‡§≤‡§æ‡§à‡§ü ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á ‡§∂‡§¨‡•ç‡§¶ (‡§∏‡•ç‡§µ‡§≤‡•ç‡§™‡§µ‡§ø‡§∞‡§æ‡§Æ ‡§¶‡•ç‡§Ø‡§æ)</span>
        <input type="text" id="uWords" placeholder="‡§â‡§¶‡§æ. ‡§®‡§ó‡§∞‡§∏‡•á‡§µ‡§ø‡§ï‡§æ, ‡§∏‡§π‡§∞ ‡§∂‡•á‡§ñ, ‡§Ö‡§ú‡§ø‡§§ ‡§™‡§µ‡§æ‡§∞">
        
        <span class="section-label">‡•©. ‡§π‡§æ‡§Ø‡§≤‡§æ‡§à‡§ü ‡§∞‡§Ç‡§ó ‡§®‡§ø‡§µ‡§°‡§æ</span>
        <div class="color-row">
            <div class="c-btn active" style="background: #009688;" onclick="setColor('#009688', '0,150,136', this)"></div>
            <div class="c-btn" style="background: #ffcc00;" onclick="setColor('#ffcc00', '255,204,0', this)"></div>
            <div class="c-btn" style="background: #0ea5e9;" onclick="setColor('#0ea5e9', '14,165,233', this)"></div>
            <input type="color" id="customColor" oninput="pickColor(this.value)" style="width:35px;height:35px;border:none;cursor:pointer;background:none;">
        </div>

        <input type="file" id="uFile" accept="image/*" onchange="loadImg(event)" style="margin-bottom:15px;">
        <input type="text" id="uWmark" value="baatmipoint.in">
        <button class="btn-gen" id="genBtn" onclick="generate()">HD ‡§™‡•ã‡§∏‡•ç‡§ü ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®</button>
    </div>
    <img id="preview" style="width:100%; display:none; margin-top:25px; border-radius:15px; border: 5px solid #0f172a;">
    <a id="saveBtn" style="display:none; background:#10b981; color:white; text-decoration:none; padding:18px; border-radius:12px; font-weight:bold; text-align:center; margin-top:12px;">‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡§∞‡§æ üì•</a>
</div>

<div id="render-wrap">
    <div id="poster">
        <img id="target-img" class="post-bg">
        <div class="post-overlay"></div>
        <div class="post-content"><div id="rt-desc" class="post-desc"></div></div>
        <div class="post-footer">
            <svg class="social-svg" viewBox="0 0 24 24"><path d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1V12h3l-.5 3h-2.5v6.8c4.56-.93 8-4.96 8-9.8z"/></svg>
            <span id="rt-foot"></span>
        </div>
    </div>
</div>

<script>
    function hexToRgb(hex) {
        let r = parseInt(hex.slice(1, 3), 16);
        let g = parseInt(hex.slice(3, 5), 16);
        let b = parseInt(hex.slice(5, 7), 16);
        return `${r},${g},${b}`;
    }

    function setColor(hex, rgb, btn) {
        document.documentElement.style.setProperty('--accent', hex);
        document.documentElement.style.setProperty('--accent-rgb', rgb);
        document.querySelectorAll('.c-btn').forEach(x => x.classList.remove('active'));
        if(btn) btn.classList.add('active');
    }

    function pickColor(hex) { setColor(hex, hexToRgb(hex), null); }

    function loadImg(e) {
        const reader = new FileReader();
        reader.onload = (event) => { document.getElementById('target-img').src = event.target.result; }
        reader.readAsDataURL(e.target.files[0]);
    }

    async function generate() {
        let text = document.getElementById('uDesc').value;
        const words = document.getElementById('uWords').value.split(',').map(w => w.trim()).filter(w => w !== "");
        
        if(!document.getElementById('target-img').src || text.trim() === "") return alert("‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§≠‡§∞‡§æ!");

        // ‡§®‡§µ‡•Ä‡§® ‡§∏‡§ø‡§∏‡•ç‡§ü‡•Ä‡§Æ: ‡§∂‡§¨‡•ç‡§¶‡§æ‡§Ç‡§®‡§æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§∏‡•ç‡§™‡•á‡§∏‡§∏‡§π ‡§∞‡§ø‡§™‡•ç‡§≤‡•á‡§∏ ‡§ï‡§∞‡§æ
        words.forEach(word => {
            const regex = new RegExp(word, 'g');
            // ‡§Ø‡•á‡§•‡•á ‡§Ü‡§™‡§£ ‡§∂‡§¨‡•ç‡§¶‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§Ü‡§ß‡•Ä ‡§è‡§ï ‡§Ö‡§¶‡•É‡§∂‡•ç‡§Ø ‡§∏‡•ç‡§™‡•á‡§∏ (&nbsp;) ‡§ú‡•ã‡§°‡§§ ‡§Ü‡§π‡•ã‡§§
            text = text.replace(regex, `&nbsp;<span class="highlight">${word}</span>&nbsp;`);
        });

        document.getElementById('rt-desc').innerHTML = text;
        document.getElementById('rt-foot').innerText = document.getElementById('uWmark').value;
        
        // Font resize logic
        const el = document.getElementById('rt-desc');
        const container = document.querySelector('.post-content');
        let size = 52; el.style.fontSize = size + 'px';
        while ((el.scrollHeight > container.offsetHeight || el.scrollWidth > container.offsetWidth) && size > 25) {
            size--; el.style.fontSize = size + 'px';
        }

        const btn = document.getElementById('genBtn');
        btn.innerText = "Processing... ‚è≥";
        
        setTimeout(() => {
            html2canvas(document.getElementById('poster'), { scale: 4, useCORS: true }).then(canvas => {
                const data = canvas.toDataURL('image/png', 1.0);
                const previewImg = document.getElementById('preview');
                const saveBtn = document.getElementById('saveBtn');
                previewImg.src = data;
                previewImg.style.display = "block";
                saveBtn.href = data;
                saveBtn.download = "BaatmiPoint_V32.png";
                saveBtn.style.display = "block";
                btn.innerText = "HD ‡§™‡•ã‡§∏‡•ç‡§ü ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ ‚ú®";
                previewImg.scrollIntoView({ behavior: 'smooth' });
            });
        }, 800);
    }
</script>
</body>
</html>
