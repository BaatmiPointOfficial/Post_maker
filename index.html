<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Baatmi Point ‚Äì Post Maker</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
*{box-sizing:border-box; -webkit-tap-highlight-color:transparent;}
body{
  margin:0;
  padding:15px;
  font-family: 'Arial', sans-serif;
  background:#121212;
  color:#eee;
}
.container{
  max-width:450px;
  margin:auto;
  background:#1e1e1e;
  padding:20px;
  border-radius:15px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
h2{ text-align:center; color:#ffcc00; margin-bottom:20px; }
label{ display:block; margin-top:12px; font-size:14px; font-weight:bold; color:#bbb; }
input, textarea{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #333;
  background:#2a2a2a;
  color:#fff;
  font-size:16px;
}

/* Yellow Button Trigger */
#generateBtn{
  width:100%;
  margin-top:20px;
  padding:15px;
  border:none;
  border-radius:10px;
  background:#ffcc00;
  color:#000;
  font-weight:bold;
  font-size:18px;
  cursor:pointer;
}
#generateBtn:active{ transform:scale(0.96); }

#preview{ margin-top:20px; text-align:center; }
#finalImage{
  max-width:100%;
  border-radius:10px;
  display:none;
  border: 2px solid #333;
}
#downloadBtn{
  display:none;
  margin-top:15px;
  background:#2ecc71;
  color:#fff;
  text-decoration:none;
  padding:15px;
  border-radius:10px;
  font-weight:bold;
  text-align:center;
  display: block;
}

/* üîë FIX: OFF-SCREEN RENDERING AREA */
/* display: none ‡§ï‡•ã ‡§π‡§ü‡§æ‡§ï‡§∞ position: absolute ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à */
#postCanvas{
  position:absolute;
  left:-5000px; 
  top:0;
  width:1080px; 
  height:1080px;
  background:#000;
  overflow:hidden;
}
#canvasWrap{
  position:relative;
  width:1080px;
  height:1080px;
}
#userImg{ width:100%; height:100%; object-fit:cover; }

/* üîë FIX: Transparent Shade (Gradient) */
#overlay{
  position:absolute;
  bottom:0;
  left:0;
  right:0;
  background: linear-gradient(transparent, rgba(0,0,0,0.85) 40%);
  padding:80px 40px 40px 40px;
}
#headlineOut{
  font-size:60px;
  line-height:1.2;
  margin:0;
  color:#ffffff; /* White Headline as per screenshot */
  font-weight:bold;
}
#descOut{
  margin-top:15px;
  font-size:32px;
  color:#ffcc00; /* Yellow Description as per screenshot */
}

/* üîë FIX: Watermark Function added */
#watermark{
  position:absolute;
  right:30px;
  bottom:30px;
  color:#ffcc00; /* Yellow Watermark as per screenshot */
  font-weight:bold;
  font-size:26px;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
}
</style>
</head>

<body>

<div class="container">
  <h2>Post Maker</h2>

  <label>‡§´‡•ã‡§ü‡•ã ‡§®‡§ø‡§µ‡§°‡§æ</label>
  <input type="file" id="imageInput" accept="image/*">

  <label>‡§π‡•á‡§°‡§≤‡§æ‡§à‡§® (‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ ‡§∞‡§Ç‡§ó)</label>
  <input type="text" id="headline" placeholder="‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§æ‡§§‡§Æ‡•Ä ‡§Ø‡•á‡§•‡•á ‡§≤‡§ø‡§π‡§æ">

  <label>‡§µ‡§ø‡§µ‡§∞‡§£ (‡§™‡§ø‡§µ‡§≥‡§æ ‡§∞‡§Ç‡§ó)</label>
  <textarea id="desc" rows="3" placeholder="‡§•‡•ã‡§°‡§ï‡•ç‡§Ø‡§æ‡§§ ‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§Ø‡•á‡§•‡•á ‡§≤‡§ø‡§π‡§æ"></textarea>

  <button id="generateBtn">‡§™‡•ã‡§∏‡•ç‡§ü ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ</button>

  <div id="preview">
    <img id="finalImage">
    <a id="downloadBtn">‡§á‡§Æ‡•á‡§ú ‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡§∞‡§æ</a>
  </div>
</div>

<div id="postCanvas">
  <div id="canvasWrap">
    <img id="userImg" src="">
    <div id="overlay">
      <h1 id="headlineOut"></h1>
      <div id="descOut"></div>
    </div>
    <div id="watermark">@baatmipoint</div>
  </div>
</div>

<script>
const imgInput = document.getElementById('imageInput');
const userImg = document.getElementById('userImg');
const headlineOut = document.getElementById('headlineOut');
const descOut = document.getElementById('descOut');
const finalImage = document.getElementById('finalImage');
const downloadBtn = document.getElementById('downloadBtn');
const generateBtn = document.getElementById('generateBtn');

imgInput.addEventListener('change', e => {
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    userImg.src = ev.target.result;
  };
  reader.readAsDataURL(file);
});

generateBtn.addEventListener('click', () => {
  if(!userImg.src || userImg.src === window.location.href){
    alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ü‡§ß‡•Ä ‡§´‡•ã‡§ü‡•ã ‡§®‡§ø‡§µ‡§°‡§æ!");
    return;
  }

  headlineOut.innerText = document.getElementById('headline').value || "";
  descOut.innerText = document.getElementById('desc').value || "";

  generateBtn.disabled = true;
  generateBtn.innerText = "‡§§‡§Ø‡§æ‡§∞ ‡§π‡•ã‡§§ ‡§Ü‡§π‡•á...";

  // DOM ‡§ï‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã‡§®‡•á ‡§ï‡§æ ‡§∏‡§Æ‡§Ø ‡§¶‡•á‡§Ç
  setTimeout(() => {
    html2canvas(document.getElementById('postCanvas'), {
      scale: 1, 
      useCORS: true,
      allowTaint: true,
      backgroundColor: "#000"
    }).then(canvas => {
      const imgData = canvas.toDataURL("image/png");
      finalImage.src = imgData;
      finalImage.style.display = "block";
      
      downloadBtn.href = imgData;
      downloadBtn.download = "BaatmiPoint_Post.png";
      downloadBtn.style.display = "block";

      generateBtn.disabled = false;
      generateBtn.innerText = "‡§™‡•ã‡§∏‡•ç‡§ü ‡§§‡§Ø‡§æ‡§∞ ‡§ï‡§∞‡§æ";
      
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }).catch(err => {
      alert("Error! ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§");
      generateBtn.disabled = false;
    });
  }, 500);
});
</script>

</body>
</html>
